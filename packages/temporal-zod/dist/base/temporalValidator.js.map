{"version":3,"file":"temporalValidator.js","sourceRoot":"","sources":["../../src/base/temporalValidator.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,CAAC,EAAE,MAAM,KAAK,CAAC;AAgBxB;;;;;GAKG;AACH,MAAM,UAAU,kBAAkB,CAKhC,GAAW;IAEX,MAAM,QAAQ,GAAG,CAAC,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;IACnC,OAAO;QACL,QAAQ;QACR,MAAM,EAAE,CAAC,CAAC,KAAK,CAAC;YACd,QAAQ;YACR,CAAC,CAAC,MAAM,EAAE,CAAC,SAAS,CAAC,CAAC,KAAK,EAAE,GAAG,EAAE,EAAE;gBAClC,IAAI,CAAC;oBACH,OAAO,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;gBACzB,CAAC;gBAAC,OAAO,KAAc,EAAE,CAAC;oBACxB,GAAG,CAAC,QAAQ,CACV,WAAW,GAAG,CAAC,IAAI,KAAM,KAA8B,CAAC,OAAO,IAAI,eAAe,EAAE,CACrF,CAAC;oBACF,OAAO,CAAC,CAAC,KAAK,CAAC;gBACjB,CAAC;YACH,CAAC,CAAC;SACH,CAAC;KACH,CAAC;AACJ,CAAC","sourcesContent":["import { z } from \"zod\";\n\n// eslint-disable-next-line @typescript-eslint/no-extraneous-class, @typescript-eslint/no-unused-vars, unused-imports/no-unused-vars\ndeclare abstract class Class {\n  constructor(..._: unknown[]);\n}\n\n/**\n * A Zod validator for a Temporal class which also parses string inputs.\n */\nexport type ZodTemporal<\n  TClass extends typeof Class & {\n    from: (arg: string) => InstanceType<TClass>;\n  },\n> = z.ZodType<InstanceType<TClass>>;\n\n/**\n * Creates Zod validators for a Temporal class.\n *\n * @param cls - The Temporal class to validate.\n * @returns Two Zod validators for the Temporal class: `coerce` for coercing strings to the Temporal class, and `instance` for validating that the value is an instance of the Temporal class.\n */\nexport function temporalValidators<\n  TClass extends typeof Class & {\n    from: (arg: string) => InstanceType<TClass>;\n  },\n>(\n  cls: TClass,\n): { coerce: ZodTemporal<TClass>; instance: z.ZodType<InstanceType<TClass>> } {\n  const instance = z.instanceof(cls);\n  return {\n    instance,\n    coerce: z.union([\n      instance,\n      z.string().transform((value, ctx) => {\n        try {\n          return cls.from(value);\n        } catch (error: unknown) {\n          ctx.addIssue(\n            `Invalid ${cls.name}: ${(error as { message?: string }).message ?? \"unknown error\"}`,\n          );\n          return z.NEVER;\n        }\n      }),\n    ]),\n  };\n}\n"]}